# Лабораторная работа №2 — Введение в AWS. Вычислительные сервисы

**Выполнил:** Alexandr Pitropov
**Группа:** I2302

## Постановка задачи

Изучить основы вычислительных сервисов AWS (Amazon Web Services) на примере Amazon EC2. Научиться создавать, настраивать и администрировать виртуальные машины (EC2-инстансы), работать с группами безопасности, подключаться по SSH и разворачивать веб-приложение с использованием Docker Compose.

---

## Цель и основные этапы работы

**Цель:** получить практические навыки работы с Amazon EC2, IAM, Security Groups, CloudWatch и Docker.

**Основные этапы:**

1. Регистрация и настройка AWS Free Tier.
2. Создание IAM-группы и пользователя.
3. Настройка бюджета (Zero Spend Budget).
4. Запуск и настройка виртуальной машины EC2.
5. Проверка логов и мониторинга.
6. Подключение к инстансу по SSH.
7. Развёртывание PHP-приложения с помощью Docker Compose.
8. Остановка инстанса и подведение итогов.

---

## Практическая часть

### Задание 0. Подготовка среды

* Зарегистрирован аккаунт AWS Free Tier.
* Регион выбран **EU (Frankfurt)**.
* Вход выполнен под IAM-пользователем с административными правами.

### Задание 1. Создание IAM-группы и пользователя

* Создана группа **Admins** с политикой `AdministratorAccess`.
* Добавлен пользователь **cloudstudent** и привязан к группе.

**Контрольный вопрос:**

> Что делает политика `AdministratorAccess`?

**Ответ:** предоставляет полный административный доступ ко всем сервисам AWS.

### Задание 2. Настройка Zero-Spend Budget

* В разделе Billing → Budgets создан бюджет `ZeroSpend`.
* Настроено уведомление на email при превышении $0 расходов.

### Задание 3. Создание и запуск EC2-инстанса

* AMI: *Amazon Linux 2023 AMI*.
* Тип: `t3.micro`.
* Имя: `webserver`.
* Создана группа безопасности `webserver-sg` с открытыми портами:

  * `22` — SSH (только с текущего IP)
  * `80` — HTTP (для всех)

**User Data:**

```bash
#!/bin/bash
dnf -y update
dnf -y install htop
dnf -y install nginx
systemctl enable nginx
systemctl start nginx
```

После запуска страница `http://<Public-IP>` открылась с надписью **Welcome to nginx!**

**Контрольный вопрос:**

> Что делает User Data и зачем используется nginx?

**Ответ:** User Data — это сценарий инициализации, выполняющийся при первом запуске инстанса. Nginx используется как веб-сервер для обработки HTTP-запросов.

---

### Задание 4. Логирование и мониторинг

* Проверены **Status checks**: 2/2 passed.
* В разделе **Monitoring** просмотрены базовые метрики CloudWatch.
* Через **Get System Log** найдено подтверждение установки пакетов `nginx` и `htop`.
* В разделе **Instance Screenshot** отображено загрузочное изображение Amazon Linux.

**Контрольный вопрос:**

> В каких случаях важно включать детализированный мониторинг?

**Ответ:** при высокой нагрузке на сервер, необходимости отслеживать производительность в реальном времени и отладке отказоустойчивости.

---

### Задание 5. Подключение к EC2 по SSH

* Подключение выполнено из PowerShell:

```bash
ssh -i .\sasha-keypair.pem ec2-user@18.195.20.5
```

* Проверен статус nginx:

```bash
systemctl status nginx
```

**Результат:** nginx активен и запущен.

**Контрольный вопрос:**

> Почему в AWS нельзя использовать пароль для входа по SSH?

**Ответ:** из соображений безопасности. SSH-ключ обеспечивает защищённую аутентификацию без риска перебора пароля.

---

### Задание 6c. Запуск PHP-приложения в Docker (DevOps)

#### Установка Docker

```bash
sudo dnf -y install docker
sudo systemctl enable docker
sudo systemctl start docker
sudo usermod -aG docker ec2-user
```

Проверка:

```bash
docker --version
Docker Compose version v2.40.1
```

#### Развёртывание PHP-приложения

1. Создана директория проекта:

   ```bash
   mkdir php-app && cd php-app
   ```
2. Создан файл `docker-compose.yml`:

   ```yaml
   version: '3.9'
   services:
     nginx:
       image: nginx:latest
       ports:
         - "80:80"
       volumes:
         - ./nginx.conf:/etc/nginx/conf.d/default.conf
         - ./app:/var/www/html
       depends_on:
         - php
     php:
       image: php:8.2-fpm
       volumes:
         - ./app:/var/www/html
     mysql:
       image: mysql:8.0
       environment:
         MYSQL_ROOT_PASSWORD: root
         MYSQL_DATABASE: testdb
       volumes:
         - db_data:/var/lib/mysql
     adminer:
       image: adminer
       ports:
         - "8080:8080"
   volumes:
     db_data:
   ```
3. Создан файл `nginx.conf` и тестовый `app/index.php`:

   ```php
   <?php phpinfo(); ?>
   ```
4. Запуск контейнеров:

   ```bash
   sudo docker compose up -d
   ```

**Результат:**

* Приложение открывается по адресу `http://18.195.20.5` (phpinfo).
* Adminer доступен по `http://18.195.20.5:8080`.

**Контрольный вопрос:**

> Для чего используется Docker Compose?

**Ответ:** для одновременного управления несколькими контейнерами (веб-сервер, база данных, php-fpm) и их автоматической настройки через единый YAML-файл.

---

### Задание 7. Завершение работы и удаление ресурсов

Инстанс остановлен через AWS Console → **Instance State → Stop instance**.

**Контрольный вопрос:**

> Чем отличается Stop от Terminate?

**Ответ:**

* **Stop** — временно выключает ВМ, сохраняя данные на диске.
* **Terminate** — полностью удаляет ВМ и связанные ресурсы.

---

## Список использованных источников

1. [AWS Documentation](https://docs.aws.amazon.com/)
2. Методические указания к лабораторной работе №2 — *Введение в AWS*
3. [Docker Documentation](https://docs.docker.com/compose/)

---

## Вывод

В ходе работы был развёрнут и сконфигурирован EC2-инстанс на AWS, настроен веб-сервер Nginx, выполнено подключение по SSH, реализовано PHP-приложение с использованием Docker Compose и успешно проведён мониторинг. Получены практические навыки DevOps-настройки и базового администрирования AWS EC2.

---

