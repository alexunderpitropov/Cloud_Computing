# Лабораторная работа №4. Облачное хранилище данных Amazon S3

**Студент:** Питропов Александр

**Группа:** I2302

## 1. Описание лабораторной работы

### 1.1. Постановка задачи

Цель лабораторной работы — изучить сервис Amazon S3, научиться работать с объектным хранилищем, создавать бакеты, загружать файлы, управлять их версиями, настраивать статический хостинг, а также использовать Lifecycle‑политики и AWS CLI.

Также выполняется дополнительное задание — загрузка файлов в S3 через веб‑форму с использованием AWS SDK for PHP.

### 1.2. Цель и основные этапы работы

В ходе работы необходимо:

* Создать публичный и приватный S3 бакеты.
* Загрузить объекты через веб‑консоль и AWS CLI.
* Настроить доступность и версионирование объектов.
* Создать Lifecycle‑политику для архивирования логов.
* Настроить статический сайт в S3.
* Реализовать загрузку файлов через AWS SDK (дополнительное задание).

---

## 2. Практическая часть

### Шаг 1. Подготовка структуры файлов

Создана локальная структура:

```
s3-lab/
 ├── public/
 │   ├── avatars/
 │   │   ├── user1.jpg
 │   │   └── user2.jpg
 │   └── content/logo.png
 ├── private/
 │   └── logs/activity.csv
 └── README.md
```

---

### Шаг 2. Создание публичного и приватного бакетов

Созданы бакеты:

* **cc-lab4-pub-k16** — публичный (ACL Enabled, Public Access OFF)
* **cc-lab4-priv-k16** — приватный (Public Access ON)

**Контрольный вопрос:** *Что означает Block all public access?> Это глобальная настройка, запрещающая любой публичный доступ к бакету и объектам. Используется для защиты данных от случайной утечки.

---

### Шаг 3. Загрузка объектов через AWS Management Console

В бакет `cc-lab4-pub-k16/avatars` загружен файл `user1.jpg` с правами `public-read`.

**Контрольный вопрос:** *Чем отличается object key от имени файла?> Object key — путь объекта внутри бакета. Он может содержать «папки», но фактически это часть имени. Имя файла — это только последняя часть ключа.

---

### Шаг 4. Загрузка объектов через AWS CLI

Команда:

```
aws s3 cp s3-lab/public/avatars/user2.jpg s3://cc-lab4-pub-k16/avatars/user2.jpg --acl public-read
```

Загружены также:

* `logo.png` → `content/logo.png`
* `activity.csv` → приватный бакет

**Контрольный вопрос:** *В чём разница между cp, mv, sync?> `cp` — копирует, `mv` — перемещает, `sync` — синхронизирует содержимое директорий.

---

### Шаг 5. Проверка доступа

Публичный объект доступен по ссылке вида:

```
https://cc-lab4-pub-k16.s3.eu-central-1.amazonaws.com/avatars/user1.jpg
```

Приватный объект — недоступен.

*

---

### Шаг 6. Версионирование объектов

Включено версионирование для двух бакетов. После перезагрузки `logo.png` появились версии.

**Контрольный вопрос:** *Что произойдёт, если выключить версионирование?> Новые версии создаваться не будут, но старые сохранятся.

---

### Шаг 7. Создание Lifecycle‑правила

Создано правило:

* 30 дней → Standard‑IA
* 365 дней → Glacier Deep Archive
* 1825 дней → удаление

**Контрольный вопрос:** *Что такое Storage Class?> Storage Class определяет уровень доступности и стоимости хранения данных. Холодные классы дешевле, но медленнее.

---

### Шаг 8. Static Website Hosting

Создан бакет `cc-lab4-web-k16`, включён хостинг.
Загружены файлы:

* index.html
* styles.css
* index.js

Сайт доступен по URL (указан в настройках бакета после включения Static Hosting).

---

### Шаг 9. Дополнительное задание — загрузка файлов через AWS SDK

Реализованы файлы:

* `index.php` — форма загрузки
* `upload.php` — загрузка файлов в S3

Использован Composer‑пакет `aws/aws-sdk-php`. Добавлена генерация уникального имени файла.

*

Пример ключа загружаемого объекта:

```
avatars/1702159323_filename.jpg
```

> Функционал SQLite и вывода списка файлов — опциональный, зависит от требований. Базовая загрузка работает.

---

## 3. Контрольные вопросы 

### 1. Чем отличаются подходы ACL и Object Ownership Enforced?

ACL позволяет управлять доступом для каждого объекта вручную. Object Ownership Enforced полностью отключает ACL и делает весь доступ управляемым только через IAM.

### 2. Что означает Block all public access?

Глобально запрещает публичный доступ к бакету и объектам.

### 3. Чем отличается ключ объекта от имени файла?

Ключ — полный путь объекта внутри бакета. Имя файла — его последняя часть.

### 4. Разница между cp, mv, sync?

* cp — копирование
* mv — перемещение
* sync — синхронизация директории

### 5. Для чего `--acl public-read`?

Даёт доступ к объекту всем пользователям интернета.

### 6. Что произойдёт при выключении Versioning?

Новые версии не создаются, старые сохраняются.

### 7. Что такое Storage Class?

Это класс хранения, определяющий стоимость, доступность и скорость доступа.

---

## 4. Список использованных источников

* AWS Documentation — Amazon S3
* AWS CLI Reference
* AWS SDK for PHP
* Материалы лабораторной работы

---

## 5. Вывод

В ходе работы были изучены ключевые возможности Amazon S3: создание бакетов, управление объектами, настройка версионирования, статический хостинг и Lifecycle‑политики. Реализована загрузка файлов через AWS SDK. Работа закрепила понимание объектного хранения и типичных сценариев его использования.

---

## 6. Дополнительные аспекты

* Добавлена демонстрация генерации уникальных имён файлов.
* Использован Composer и AWS SDK.

